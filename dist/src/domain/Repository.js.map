{"version":3,"sources":["domain/Repository.js"],"names":[],"mappings":";;;;;;2BAA4B,wBAAwB;;IAEvC,UAAU;AACV,UADA,UAAU,CACT,UAAU,EAAE,cAAc,EAAE,kBAAkB,EAAE;wBADjD,UAAU;;AAErB,MAAI,UAAU,KAAK,SAAS,IAAI,UAAU,KAAK,IAAI,EAAE;AACpD,SAAM,IAAI,KAAK,CAAC,6BAA6B,CAAC,CAAC;GAC/C;AACD,MAAI,cAAc,KAAK,SAAS,IAAI,cAAc,KAAK,IAAI,EAAE;AAC5D,SAAM,IAAI,KAAK,CAAC,iCAAiC,CAAC,CAAC;GACnD;AACD,MAAI,kBAAkB,KAAK,SAAS,IAAI,kBAAkB,KAAK,IAAI,EAAE;AACpE,SAAM,IAAI,KAAK,CAAC,qCAAqC,CAAC,CAAC;GACvD;;AAED,MAAI,CAAC,UAAU,GAAG,UAAU,CAAC;AAC7B,MAAI,CAAC,cAAc,GAAG,cAAc,CAAC;AACrC,MAAI,CAAC,kBAAkB,GAAG,kBAAkB,CAAC;EAC7C;;AAfW,WAAU,WAiBtB,SAAS,GAAA,mBAAC,WAAW,EAAE,KAAK,EAAE,QAAQ,EAAE;AACvC,MAAI,CAAC,UAAU,CAAC,MAAM,CAAC,EAAC,WAAW,EAAE,WAAW,EAAE,KAAK,EAAE,KAAK,EAAC,EAAE,UAAA,CAAC;UAAI,QAAQ,CAAC,CAAC,CAAC;GAAA,CAAC,CAAC;AACnF,MAAI,CAAC,YAAY,CAAC,KAAK,EAAE,UAAA,CAAC;UAAI,QAAQ,CAAC,CAAC,CAAC;GAAA,CAAC,CAAC;EAC3C;;AApBW,WAAU,WAsBtB,YAAY,GAAA,sBAAC,KAAK,EAAE,QAAQ,EAAC;AAC5B,MAAI,KAAK,yBAzBF,WAAW,AAyBc,EAAE;AACjC,OAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAC,MAAM,EAAE,KAAK,CAAC,MAAM,EAAE,WAAW,EAAE,KAAK,CAAC,WAAW,EAAE,EAAE,QAAQ,CAAC,CAAC;GAC9F;EACD;;AA1BW,WAAU,WA4BtB,UAAU,GAAA,oBAAC,QAAQ,EAAE;AACpB,SAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;EAC9C;;AA9BW,WAAU,WAgCtB,cAAc,GAAA,wBAAC,QAAQ,EAAE;AACxB,SAAO,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;EAClD;;QAlCW,UAAU;;;QAAV,UAAU,GAAV,UAAU","file":"domain/Repository.js","sourcesContent":["import { PostCreated } from \"./posts/PostCreated.js\";\r\n\r\nexport class Repository {\r\n\tconstructor (eventStore, draftPostStore, publishedPostStore) {\r\n\t\tif (eventStore === undefined || eventStore === null) {\r\n\t\t\tthrow new Error(\"eventStore argument missing\");\r\n\t\t}\r\n\t\tif (draftPostStore === undefined || draftPostStore === null) {\r\n\t\t\tthrow new Error(\"draftPostStore argument missing\");\r\n\t\t}\r\n\t\tif (publishedPostStore === undefined || publishedPostStore === null) {\r\n\t\t\tthrow new Error(\"publishedPostStore argument missing\");\r\n\t\t}\r\n\r\n\t\tthis.eventStore = eventStore;\r\n\t\tthis.draftPostStore = draftPostStore;\r\n\t\tthis.publishedPostStore = publishedPostStore;\r\n\t}\r\n\t\r\n\tSaveEvent(aggregateId, event, callback) {\r\n\t\tthis.eventStore.insert({aggregateId: aggregateId, event: event}, e => callback(e));\r\n\t\tthis.PublishEvent(event, e => callback(e));\r\n\t}\r\n\t\r\n\tPublishEvent(event, callback){\r\n\t\tif (event instanceof PostCreated) {\r\n\t\t\tthis.draftPostStore.insert({postId: event.postId, dateCreated: event.dateCreated }, callback);\t\t\t\r\n\t\t}\r\n\t}\r\n\t\r\n\tDraftPosts(callback) {\r\n\t\treturn this.draftPostStore.find({}, callback);\r\n\t}\r\n\t\r\n\tPublishedPosts(callback) {\r\n\t\treturn this.publishedPostStore.find({}, callback);\r\n\t}\r\n}"],"sourceRoot":"/source/"}